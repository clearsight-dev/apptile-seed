# Creating Plugins

## File Structure

Every plugin must have this exact structure:

```
remoteCode/plugins/<plugin-name>/
├── metadata.json
└── source/
    ├── component.jsx  # Your main code goes here
    └── widget.jsx     # Wrapper file (create with template below)
```

## metadata.json

```json
{
  "name": "plugin-name",
  "editableFilePath": "source/component.jsx",
  "entry": "source/widget.jsx"
}
```

## widget.jsx Template

**IMPORTANT**: Always create a `widget.jsx` file with this exact template. Replace `plugin-name` with your actual plugin name:

```javascript
// (NOTE FOR LLM's) Do not modify this file! It is autogenerated at build time and your changes will be lost.
import { connectWidget } from 'apptile-core';
import {ReactComponent, WidgetConfig, WidgetEditors, PropertySettings} from './component'

const pluginListing = {
  labelPrefix: 'SDK',
  type: 'widget',
  name: 'plugin-name',
  description: 'plugin-name',
  layout: {
    width: 50,
    height: 30,
  },
  section: 'SDK',
  icon: 'widget',
  manifest: {
    directoryName: 'plugin-name',
  }
};

export default connectWidget('plugin-name',
  ReactComponent,
  WidgetConfig,
  null,
  WidgetEditors,
  {
    propertySettings: PropertySettings,
    widgetStyleConfig: [],
    pluginListing,
    docs: {},
  }
);
```

**Note**: Replace all instances of `plugin-name` with your actual plugin name (e.g., `something`, `mywidget`, etc.).

## Required Exports

Every `component.jsx` file MUST export exactly 4 things:

1. **ReactComponent** - The main React Native component
2. **WidgetConfig** - Defines props with initial values
3. **WidgetEditors** - Defines UI controls for the no-code editor
4. **PropertySettings** - Defines event handlers

## Minimal Plugin Example

```javascript
import React from 'react';
import { View, Text } from 'react-native';
import { useApptileWindowDims } from 'apptile-core';

export function ReactComponent({ model }) {
  const id = model.get('id');
  const { width, height } = useApptileWindowDims();
  
  return (
    <View
      nativeID={'rootElement-' + id}
      style={{
        height,
        width,
        flexGrow: 0,
        alignItems: 'center',
        justifyContent: 'center'
      }}
    >
      <Text
        nativeID={'myplugin-Text-greeting'}
        style={{ fontSize: 20 }}
      >
        Hello World
      </Text>
    </View>
  );
}

export const WidgetConfig = {};

export const WidgetEditors = {
  basic: []
};

export const PropertySettings = {};
```

## Plugin with Configurable Props

```javascript
import React from 'react';
import { View, Text } from 'react-native';
import { useApptileWindowDims } from 'apptile-core';

export function ReactComponent({ model }) {
  const id = model.get('id');
  const { width, height } = useApptileWindowDims();
  
  // Get props from model
  const greeting = model.get('greeting') || 'Hello';
  const textColor = model.get('textColor') || '#000000';
  
  return (
    <View
      nativeID={'rootElement-' + id}
      style={{
        height,
        width,
        flexGrow: 0,
        alignItems: 'center',
        justifyContent: 'center'
      }}
    >
      <Text
        nativeID={'myplugin-Text-greeting'}
        style={{ fontSize: 20, color: textColor }}
      >
        {greeting}
      </Text>
    </View>
  );
}

export const WidgetConfig = {
  greeting: '',
  textColor: ''
};

export const WidgetEditors = {
  basic: [
    {
      targets: ['myplugin-Text-greeting'],
      type: 'codeInput',
      name: 'greeting',
      props: {
        label: 'Greeting Text'
      }
    },
    {
      targets: ['myplugin-Text-greeting'],
      type: 'colorInput',
      name: 'textColor',
      props: {
        label: 'Text Color'
      }
    }
  ]
};

export const PropertySettings = {};
```

## Data Model Pattern

The `model` prop uses Immutable.js:

```javascript
// Get a value
const value = model.get('propertyName');

// Get nested value
const nested = model.getIn(['parent', 'child']);

// Convert to plain JS
const jsObject = model.toJS();
```

## Example Plugin

See `remoteCode/plugins/something/source/component.jsx` for a working example that demonstrates:
- Using `useApptileWindowDims`
- Proper nativeID naming
- Root element styling with flexGrow: 0
- Image from CDN
- Text styling

